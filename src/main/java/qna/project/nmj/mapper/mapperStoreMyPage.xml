<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="qna.project.nmj.beans.dao.StoreMyPageDAO">
	<select id="reviewSelect" resultType="qna.project.nmj.beans.ReviewJoinDTO">
		SELECT a.review_uid, a.mb_uid, a.store_uid, a.review_rate, a.review_content, a.review_ban, a.review_viewCount, a.review_date, b.store_type, b.store_name, c.mb_id
		FROM NMJ_review a , NMJ_store b, NMJ_member c
		WHERE a.store_uid = b.store_uid 
		AND a.mb_uid = c.mb_uid
		AND a.store_uid = #{store_uid} 
		ORDER BY review_uid DESC
	</select>
	
	
	<select id="selectStoreByUid" resultType="qna.project.nmj.beans.StoreDTO" flushCache="true">
		SELECT
			store_uid,
			mb_uid,
			store_name,
			store_address,
			store_tel,
			store_hours,
			store_content,
			store_img_org,
			store_img_sav,
			store_regNum,
			store_regImg_org,
			store_regImg_sav,
			store_lat,
			store_long,
			store_type,
			store_dtype,
			store_ratings,
			store_rateCount
		FROM
			nmj_store
		WHERE
			store_uid = #{store_uid}
		;
	</select>
	<update id="updateStoreWOImageByUid" flushCache="true">
		UPDATE
			nmj_store
		SET
			store_tel = #{dto.store_tel},
			store_hours = #{dto.store_hours},
			store_content = #{dto.store_content}
		WHERE
			store_uid = #{dto.store_uid}
		;
	</update>
	<update id="updateStoreWImageByUid" flushCache="true">
		UPDATE
			nmj_store
		SET
			store_tel = #{dto.store_tel},
			store_hours = #{dto.store_hours},
			store_content = #{dto.store_content},
			store_img_org = #{dto.store_img_org},
			store_img_sav = #{dto.store_img_sav}
		WHERE
			store_uid = #{dto.store_uid}
		;
	</update>
	<select id="selectAllStoreDType" resultType="qna.project.nmj.beans.StoreTypeDTO">
		SELECT 
			*
		FROM
			nmj_storedtype
		ORDER BY
			store_type ASC, store_dtype ASC
		;
	</select>
	
</mapper>